{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { Box, Text, ScrollView, HStack, Pressable, View, Image, VStack, Input, FormControl, TextArea } from \"native-base\";\nimport React, { useState } from \"react\";\nimport Colors from \"../color\";\nimport { Ionicons, Entypo } from \"@expo/vector-icons\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport { StorageClient } from \"@supabase/storage-js\";\nimport { useDispatch } from \"react-redux\";\nimport { updateAvatar } from \"../Redux/Actions/UserActions\";\nimport ToastAndroid from \"react-native-web/dist/exports/ToastAndroid\";\nimport { AirbnbRating } from \"react-native-ratings\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar STORAGE_URL = \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1\";\nvar SERVICE_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nZnhiYWdramh4eXB1dG13b3hwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY3MDIyMDE2NSwiZXhwIjoxOTg1Nzk2MTY1fQ.v1Bml2eA_eQno7gMBfDbtgLiyovkVs9orOz1w_89aVI\";\n\nvar storageClient = new StorageClient(STORAGE_URL, {\n  apikey: SERVICE_KEY,\n  Authorization: \"Bearer \" + SERVICE_KEY\n});\nfunction ReviewScreen(_ref) {\n  var navigation = _ref.navigation,\n    route = _ref.route;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    avatar = _useState2[0],\n    setAvatar = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    pass = _useState4[0],\n    setPass = _useState4[1];\n  var userInfo = route.params;\n  var dispatch = useDispatch();\n  var updateImage = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var result = yield ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.Images,\n          allowsEditing: true,\n          aspect: [4, 3],\n          quality: 1\n        });\n        if (!result.canceled) {\n          var ext = result.assets[0].uri.substring(result.assets[0].uri.lastIndexOf(\".\") + 1);\n          var fileName = result.assets[0].uri.replace(/^.*[\\\\\\/]/, \"\");\n          setAvatar(result.assets[0].uri);\n          var formData = new FormData();\n          formData.append(\"files\", {\n            uri: result.assets[0].uri,\n            name: fileName,\n            type: \"image/\" + ext\n          });\n          var _yield$storageClient$ = yield storageClient.from(\"image\").upload(fileName, formData),\n            data = _yield$storageClient$.data,\n            error = _yield$storageClient$.error;\n          if (error) {\n            throw error;\n            ToastAndroid.show(\"Cập nhập ảnh đại diện thất bại\", ToastAndroid.SHORT);\n          }\n          if (data) {\n            dispatch(updateAvatar(userInfo._id, \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1/object/public/image/\" + fileName, pass));\n            ToastAndroid.show(\"Cập nhập ảnh đại diện thành công\", ToastAndroid.LONG);\n          }\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    });\n    return function updateImage() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsxs(Box, {\n    safeAreaTop: true,\n    bg: Colors.white,\n    children: [_jsxs(HStack, {\n      space: 3,\n      w: \"full\",\n      px: 4,\n      bg: \"#FFA500\",\n      py: 3,\n      alignItems: \"center\",\n      safeAreaTop: true,\n      children: [_jsx(Pressable, {\n        onPress: function onPress() {\n          return navigation.goBack();\n        },\n        children: _jsx(Ionicons, {\n          name: \"arrow-back\",\n          size: 24,\n          color: \"white\"\n        })\n      }), _jsx(Text, {\n        bold: true,\n        fontSize: 17,\n        color: \"white\",\n        children: \"\\u0110\\xE1nh gi\\xE1\"\n      })]\n    }), _jsxs(View, {\n      children: [_jsx(Text, {\n        fontSize: 15,\n        bold: true,\n        mb: 4,\n        children: \"\\u0110\\xE1nh gi\\xE1\"\n      }), _jsxs(VStack, {\n        space: 6,\n        children: [_jsxs(FormControl, {\n          children: [_jsx(FormControl.Label, {\n            _text: {\n              fontSize: \"12px\",\n              fontWeight: \"bold\"\n            },\n            children: \"Rating\"\n          }), _jsx(AirbnbRating, {\n            reviewSize: 12,\n            size: 25,\n            defaultRating: 0\n          })]\n        }), _jsxs(FormControl, {\n          children: [_jsx(FormControl.Label, {\n            _text: {\n              fontSize: \"12px\",\n              fontWeight: \"bold\"\n            },\n            children: \"Comment\"\n          }), _jsx(TextArea, {\n            h: 24,\n            w: \"full\",\n            placeholder: \"This product.........\",\n            borderWidth: 0,\n            bg: \"#F8F8FF\",\n            py: 4,\n            _focus: {\n              bg: \"#F8F8FF\"\n            }\n          })]\n        }), _jsx(Pressable, {\n          bg: \"#EE9A00\",\n          color: Colors.white,\n          children: _jsx(Text, {\n            children: \"\\u0110\\xC1NH GI\\xC1\"\n          })\n        })]\n      })]\n    })]\n  });\n}\nexport default ReviewScreen;","map":{"version":3,"names":["Box","Text","ScrollView","HStack","Pressable","View","Image","VStack","Input","FormControl","TextArea","React","useState","Colors","Ionicons","Entypo","ImagePicker","StorageClient","useDispatch","updateAvatar","AirbnbRating","STORAGE_URL","SERVICE_KEY","storageClient","apikey","Authorization","ReviewScreen","navigation","route","avatar","setAvatar","pass","setPass","userInfo","params","dispatch","updateImage","result","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","aspect","quality","canceled","ext","assets","uri","substring","lastIndexOf","fileName","replace","formData","FormData","append","name","type","from","upload","data","error","ToastAndroid","show","SHORT","_id","LONG","console","log","white","goBack","fontSize","fontWeight","bg"],"sources":["F:/DoAn/DACN1/ShopApp/src/Screens/ReviewScreen.js"],"sourcesContent":["import {\r\n  Box,\r\n  Text,\r\n  ScrollView,\r\n  HStack,\r\n  Pressable,\r\n  View,\r\n  Image,\r\n  VStack,\r\n  Input,\r\n  FormControl,\r\n  TextArea,\r\n} from \"native-base\";\r\nimport React, { useState } from \"react\";\r\nimport Colors from \"../color\";\r\nimport { Ionicons, Entypo } from \"@expo/vector-icons\";\r\nimport * as ImagePicker from \"expo-image-picker\";\r\nimport { StorageClient } from \"@supabase/storage-js\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { updateAvatar } from \"../Redux/Actions/UserActions\";\r\nimport { ToastAndroid } from \"react-native\";\r\nimport { AirbnbRating } from \"react-native-ratings\";\r\nconst STORAGE_URL = \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1\";\r\nconst SERVICE_KEY =\r\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nZnhiYWdramh4eXB1dG13b3hwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY3MDIyMDE2NSwiZXhwIjoxOTg1Nzk2MTY1fQ.v1Bml2eA_eQno7gMBfDbtgLiyovkVs9orOz1w_89aVI\"; //! service key, not anon key\r\n\r\nconst storageClient = new StorageClient(STORAGE_URL, {\r\n  apikey: SERVICE_KEY,\r\n  Authorization: `Bearer ${SERVICE_KEY}`,\r\n});\r\nfunction ReviewScreen({ navigation, route }) {\r\n  const [avatar, setAvatar] = useState(null);\r\n  const [pass, setPass] = useState(null);\r\n  const userInfo = route.params;\r\n  const dispatch = useDispatch();\r\n  const updateImage = async () => {\r\n    try {\r\n      let result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        allowsEditing: true,\r\n        aspect: [4, 3],\r\n        quality: 1,\r\n      });\r\n      if (!result.canceled) {\r\n        const ext = result.assets[0].uri.substring(\r\n          result.assets[0].uri.lastIndexOf(\".\") + 1\r\n        );\r\n        const fileName = result.assets[0].uri.replace(/^.*[\\\\\\/]/, \"\");\r\n        setAvatar(result.assets[0].uri);\r\n        const formData = new FormData();\r\n        formData.append(\"files\", {\r\n          uri: result.assets[0].uri,\r\n          name: fileName,\r\n          type: `image/${ext}`,\r\n        });\r\n\r\n        const { data, error } = await storageClient\r\n          .from(\"image\")\r\n          .upload(fileName, formData);\r\n        if (error) {\r\n          throw error;\r\n          ToastAndroid.show(\r\n            \"Cập nhập ảnh đại diện thất bại\",\r\n            ToastAndroid.SHORT\r\n          );\r\n        }\r\n        if (data) {\r\n          dispatch(\r\n            updateAvatar(\r\n              userInfo._id,\r\n              \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1/object/public/image/\" +\r\n                fileName,\r\n              pass\r\n            )\r\n          );\r\n          ToastAndroid.show(\r\n            \"Cập nhập ảnh đại diện thành công\",\r\n            ToastAndroid.LONG\r\n          );\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  return (\r\n    <Box safeAreaTop bg={Colors.white}>\r\n      {/* Header */}\r\n      <HStack\r\n        space={3}\r\n        w=\"full\"\r\n        px={4}\r\n        bg=\"#FFA500\"\r\n        py={3}\r\n        alignItems=\"center\"\r\n        safeAreaTop\r\n      >\r\n        <Pressable onPress={() => navigation.goBack()}>\r\n          <Ionicons name=\"arrow-back\" size={24} color=\"white\" />\r\n        </Pressable>\r\n        <Text bold fontSize={17} color=\"white\">\r\n          Đánh giá\r\n        </Text>\r\n      </HStack>\r\n      {/* Body */}\r\n      <View>\r\n        <Text fontSize={15} bold mb={4}>\r\n          Đánh giá\r\n        </Text>\r\n        <VStack space={6}>\r\n          <FormControl>\r\n            <FormControl.Label\r\n              _text={{\r\n                fontSize: \"12px\",\r\n                fontWeight: \"bold\",\r\n              }}\r\n            >\r\n              Rating\r\n            </FormControl.Label>\r\n\r\n            <AirbnbRating reviewSize={12} size={25} defaultRating={0} />\r\n          </FormControl>\r\n          <FormControl>\r\n            <FormControl.Label\r\n              _text={{\r\n                fontSize: \"12px\",\r\n                fontWeight: \"bold\",\r\n              }}\r\n            >\r\n              Comment\r\n            </FormControl.Label>\r\n            <TextArea\r\n              h={24}\r\n              w=\"full\"\r\n              placeholder=\"This product.........\"\r\n              borderWidth={0}\r\n              bg=\"#F8F8FF\"\r\n              py={4}\r\n              _focus={{ bg: \"#F8F8FF\" }}\r\n            ></TextArea>\r\n          </FormControl>\r\n          <Pressable bg=\"#EE9A00\" color={Colors.white}>\r\n            <Text>ĐÁNH GIÁ</Text>\r\n          </Pressable>\r\n        </VStack>\r\n      </View>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default ReviewScreen;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}