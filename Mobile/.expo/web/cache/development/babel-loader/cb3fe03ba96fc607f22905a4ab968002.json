{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { Button, Image, Text, View } from \"native-base\";\nimport { useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { StorageClient } from \"@supabase/storage-js\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nfunction TestScreen() {\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    uploading = _useState2[0],\n    setUploading = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    avatarUrl = _useState4[0],\n    setAvatarUrl = _useState4[1];\n  var avatarSize = {\n    height: 150,\n    width: 150\n  };\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    image = _useState6[0],\n    setImage = _useState6[1];\n  var STORAGE_URL = \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1\";\n  var SERVICE_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nZnhiYWdramh4eXB1dG13b3hwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY3MDIyMDE2NSwiZXhwIjoxOTg1Nzk2MTY1fQ.v1Bml2eA_eQno7gMBfDbtgLiyovkVs9orOz1w_89aVI\";\n\n  var storageClient = new StorageClient(STORAGE_URL, {\n    apikey: SERVICE_KEY,\n    Authorization: \"Bearer \" + SERVICE_KEY\n  });\n  function get() {\n    return _get.apply(this, arguments);\n  }\n  function _get() {\n    _get = _asyncToGenerator(function* () {\n      var _yield$storageClient$ = yield storageClient.createBucket(\"bucket\",\n        {\n          public: true\n        }),\n        data = _yield$storageClient$.data,\n        error = _yield$storageClient$.error;\n      console.log(data, error);\n    });\n    return _get.apply(this, arguments);\n  }\n  function uploadAvatar() {\n    return _uploadAvatar.apply(this, arguments);\n  }\n  function _uploadAvatar() {\n    _uploadAvatar = _asyncToGenerator(function* () {\n      try {\n        setUploading(true);\n        var result = yield ImagePicker.launchImageLibraryAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.All,\n          allowsEditing: true,\n          aspect: [4, 3],\n          quality: 1\n        });\n        var ext = result.assets[0].uri.substring(result.assets[0].uri.lastIndexOf(\".\") + 1);\n        var fileName = result.assets[0].uri.replace(/^.*[\\\\\\/]/, \"\");\n        var formData = new FormData();\n        formData.append(\"files\", {\n          uri: result.assets[0].uri,\n          name: fileName,\n          type: \"image/\" + ext\n        });\n\n        var _yield$storageClient$2 = yield storageClient.from(\"bucket\").upload(fileName, formData),\n          data = _yield$storageClient$2.data,\n          error = _yield$storageClient$2.error;\n        if (error) {\n          throw error;\n        }\n        console.log(fileName);\n        if (!result.canceled) {\n          setAvatarUrl(result.assets[0].uri);\n          setImage(fileName);\n        }\n      } catch (error) {\n        console.log(error);\n      } finally {\n        setUploading(false);\n      }\n    });\n    return _uploadAvatar.apply(this, arguments);\n  }\n  return _jsxs(View, {\n    children: [avatarUrl ? _jsx(Image, {\n      source: {\n        uri: \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1/object/public/bucket/ab23709b-7294-49d4-afdf-633e516e9568.jpeg\"\n      },\n      alt: \"a\",\n      accessibilityLabel: \"Avatar\",\n      style: [avatarSize, styles.avatar, styles.image]\n    }) : _jsx(View, {\n      style: [avatarSize, styles.avatar, styles.noImage]\n    }), _jsxs(View, {\n      children: [_jsx(Button, {\n        title: uploading ? \"Uploading ...\" : \"Upload\",\n        onPress: function onPress() {\n          return uploadAvatar();\n        },\n        disabled: uploading\n      }), _jsx(Button, {\n        title: uploading ? \"Uploading ...\" : \"Upload\",\n        onPress: function onPress() {\n          return get();\n        },\n        disabled: uploading,\n        children: \"GET\"\n      }), _jsx(Image, {\n        source: {\n          uri: \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1/object/public/bucket/ab23709b-7294-49d4-afdf-633e516e9568.jpeg\"\n        },\n        alt: \"a\",\n        accessibilityLabel: \"Avatar\",\n        style: [avatarSize, styles.avatar, styles.image]\n      })]\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  avatar: {\n    borderRadius: 5,\n    overflow: \"hidden\",\n    maxWidth: \"100%\"\n  },\n  image: {\n    objectFit: \"cover\",\n    paddingTop: 0\n  },\n  noImage: {\n    backgroundColor: \"#333\",\n    border: \"1px solid rgb(200, 200, 200)\",\n    borderRadius: 5\n  }\n});\nexport default TestScreen;","map":{"version":3,"names":["Button","Image","Text","View","useState","StorageClient","ImagePicker","TestScreen","uploading","setUploading","avatarUrl","setAvatarUrl","avatarSize","height","width","image","setImage","STORAGE_URL","SERVICE_KEY","storageClient","apikey","Authorization","get","createBucket","public","data","error","console","log","uploadAvatar","result","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","ext","assets","uri","substring","lastIndexOf","fileName","replace","formData","FormData","append","name","type","from","upload","canceled","styles","avatar","noImage","StyleSheet","create","borderRadius","overflow","maxWidth","objectFit","paddingTop","backgroundColor","border"],"sources":["F:/DoAn/DACN1/ShopApp/src/Screens/TestScreen.js"],"sourcesContent":["import { Button, Image, Text, View } from \"native-base\";\r\nimport { useState } from \"react\";\r\nimport { StyleSheet } from \"react-native\";\r\nimport { StorageClient } from \"@supabase/storage-js\";\r\nimport * as ImagePicker from \"expo-image-picker\";\r\n\r\nfunction TestScreen() {\r\n  const [uploading, setUploading] = useState(false);\r\n  const [avatarUrl, setAvatarUrl] = useState(null);\r\n  const avatarSize = { height: 150, width: 150 };\r\n  const [image, setImage] = useState(null);\r\n\r\n  const STORAGE_URL = \"https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1\";\r\n  const SERVICE_KEY =\r\n    \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nZnhiYWdramh4eXB1dG13b3hwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTY3MDIyMDE2NSwiZXhwIjoxOTg1Nzk2MTY1fQ.v1Bml2eA_eQno7gMBfDbtgLiyovkVs9orOz1w_89aVI\"; //! service key, not anon key\r\n\r\n  const storageClient = new StorageClient(STORAGE_URL, {\r\n    apikey: SERVICE_KEY,\r\n    Authorization: `Bearer ${SERVICE_KEY}`,\r\n  });\r\n  async function get() {\r\n    const { data, error } = await storageClient.createBucket(\r\n      \"bucket\", // Bucket name (must be unique)\r\n      { public: true } // Bucket options\r\n    );\r\n    console.log(data, error);\r\n  }\r\n  async function uploadAvatar() {\r\n    try {\r\n      setUploading(true);\r\n\r\n      let result = await ImagePicker.launchImageLibraryAsync({\r\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\r\n        allowsEditing: true,\r\n        aspect: [4, 3],\r\n        quality: 1,\r\n      });\r\n      const ext = result.assets[0].uri.substring(\r\n        result.assets[0].uri.lastIndexOf(\".\") + 1\r\n      );\r\n      const fileName = result.assets[0].uri.replace(/^.*[\\\\\\/]/, \"\");\r\n      const formData = new FormData();\r\n      formData.append(\"files\", {\r\n        uri: result.assets[0].uri,\r\n        name: fileName,\r\n        type: `image/${ext}`,\r\n      });\r\n\r\n      // const formData = new FormData();\r\n      // formData.append(\"image\", photo);\r\n\r\n      // const fileExt = photo.name.split(\".\").pop();\r\n      // const filePath = `${Math.random()}.${fileExt}`;\r\n\r\n      const { data, error } = await storageClient\r\n        .from(\"bucket\")\r\n        .upload(fileName, formData);\r\n\r\n      if (error) {\r\n        throw error;\r\n      }\r\n      console.log(fileName);\r\n      if (!result.canceled) {\r\n        setAvatarUrl(result.assets[0].uri);\r\n        setImage(fileName);\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <View>\r\n      {avatarUrl ? (\r\n        <Image\r\n          source={{\r\n            uri: `https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1/object/public/bucket/ab23709b-7294-49d4-afdf-633e516e9568.jpeg`,\r\n          }}\r\n          alt=\"a\"\r\n          accessibilityLabel=\"Avatar\"\r\n          style={[avatarSize, styles.avatar, styles.image]}\r\n        />\r\n      ) : (\r\n        <View style={[avatarSize, styles.avatar, styles.noImage]} />\r\n      )}\r\n      <View>\r\n        <Button\r\n          title={uploading ? \"Uploading ...\" : \"Upload\"}\r\n          onPress={() => uploadAvatar()}\r\n          disabled={uploading}\r\n        ></Button>\r\n        <Button\r\n          title={uploading ? \"Uploading ...\" : \"Upload\"}\r\n          onPress={() => get()}\r\n          disabled={uploading}\r\n        >\r\n          GET\r\n        </Button>\r\n        <Image\r\n          source={{\r\n            uri: `https://ngfxbagkjhxyputmwoxp.supabase.co/storage/v1/object/public/bucket/ab23709b-7294-49d4-afdf-633e516e9568.jpeg`,\r\n          }}\r\n          alt=\"a\"\r\n          accessibilityLabel=\"Avatar\"\r\n          style={[avatarSize, styles.avatar, styles.image]}\r\n        />\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  avatar: {\r\n    borderRadius: 5,\r\n    overflow: \"hidden\",\r\n    maxWidth: \"100%\",\r\n  },\r\n  image: {\r\n    objectFit: \"cover\",\r\n    paddingTop: 0,\r\n  },\r\n  noImage: {\r\n    backgroundColor: \"#333\",\r\n    border: \"1px solid rgb(200, 200, 200)\",\r\n    borderRadius: 5,\r\n  },\r\n});\r\nexport default TestScreen;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}